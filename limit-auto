#auto change limit


cores=$(nproc --all)
limit20CPU=$((cores * 25))
limit60CPU=$((cores * 75))


cat /dev/null > /root/limit20.sh
cat >>/root/limit20.sh <<EOF
while  pkill cpulimit ; cpulimit --limit=$limit20CPU -P deroluna-miner -b -q; do
    sleep 4h
done
EOF
chmod +x /root/limit20.sh


cat /dev/null > /root/limit60.sh
cat >>/root/limit60.sh <<EOF
while  pkill cpulimit ; cpulimit --limit=$limit60CPU -P deroluna-miner -b -q; do
    sleep 4h
done
EOF
chmod +x /root/limit60.sh



cat /dev/null > /root/limit.sh
cat >>/root/limit.sh <<EOF
nohup ./test1.sh &
sleep 2h 
nohup ./test2.sh &
EOF
chmod +x /root/limit.sh

./limit.sh
